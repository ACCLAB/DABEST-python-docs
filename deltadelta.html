
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Tutorial: Delta - Delta &#8212; dabest 0.3.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/alabaster-custom.css" />
    <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorial: Controlling Plot Aesthetics" href="plotaesthetics.html" />
    <link rel="prev" title="Tutorial: Mini-Meta Delta" href="minimetadelta.html" />

   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-120627927-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-120627927-1');
</script>


  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tutorial-delta-delta">
<span id="delta-delta-tutorial"></span><h1>Tutorial: Delta - Delta<a class="headerlink" href="#tutorial-delta-delta" title="Permalink to this heading">¶</a></h1>
<p>Since version 2023.02.14, DABEST also supports the calculation of delta-delta, an experimental function that allows the comparison between two bootstrapped effect sizes computed from two independent categorical variables.</p>
<p>Many experimental designs investigate the effects of two interacting independent variables on a dependent variable. The delta-delta effect size lets us distill the net effect of the two variables. To illustrate this, let’s delve into the following  problem.</p>
<p>Consider an experiment where we test the efficacy of a drug named <code class="docutils literal notranslate"><span class="pre">Drug</span></code> on a disease-causing mutation <code class="docutils literal notranslate"><span class="pre">M</span></code> based on disease metric <code class="docutils literal notranslate"><span class="pre">Y</span></code>. The greater value <code class="docutils literal notranslate"><span class="pre">Y</span></code> has the more severe the disease phenotype is. Phenotype <code class="docutils literal notranslate"><span class="pre">Y</span></code> has been shown to be caused by a gain of function mutation <code class="docutils literal notranslate"><span class="pre">M</span></code>, so we expect a difference between wild type (<code class="docutils literal notranslate"><span class="pre">W</span></code>) subjects and mutant subjects (<code class="docutils literal notranslate"><span class="pre">M</span></code>). Now, we want to know whether this effect is ameliorated by the administration of <code class="docutils literal notranslate"><span class="pre">Drug</span></code> treatment. We also administer a placebo as a control. In theory, we only expect <code class="docutils literal notranslate"><span class="pre">Drug</span></code> to have an effect on the <code class="docutils literal notranslate"><span class="pre">M</span></code> group, although in practice many drugs have non-specific effects on healthy populations too.</p>
<p>Effectively, we have 4 groups of subjects for comparison.</p>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1">

  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wildtype</th>
      <th>Mutant</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <th>Drug</th>
      <td>X<sub>D, W</sub></td>
      <td>X<sub>D, M</sub></td>
    </tr>

    <tr>
      <th>Placebo</th>
      <td>X<sub>P, W</sub></td>
      <td>X<sub>P, M</sub></td>
    </tr>

  </tbody>

</table>

</div><p>There are 2 <code class="docutils literal notranslate"><span class="pre">Treatment</span></code> conditions, <code class="docutils literal notranslate"><span class="pre">Placebo</span></code> (control group) and <code class="docutils literal notranslate"><span class="pre">Drug</span></code> (test group). There are 2 <code class="docutils literal notranslate"><span class="pre">Genotype</span></code> s: <code class="docutils literal notranslate"><span class="pre">W</span></code> (wildtype population) and <code class="docutils literal notranslate"><span class="pre">M</span></code> (mutant population). In addition, each experiment was done twice (<code class="docutils literal notranslate"><span class="pre">Rep1</span></code> and <code class="docutils literal notranslate"><span class="pre">Rep2</span></code>). We shall do a few analyses to visualise these differences in a simulated dataset.</p>
<section id="simulate-a-dataset">
<h2>Simulate a dataset<a class="headerlink" href="#simulate-a-dataset" title="Permalink to this heading">¶</a></h2>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>  <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 2</span>  <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="linenos"> 3</span>  <span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span> <span class="c1"># Used in generation of populations.</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span> <span class="c1"># Fix the seed so the results are replicable.</span>
<span class="linenos"> 6</span>  <span class="c1"># pop_size = 10000 # Size of each population.</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>  <span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span> <span class="c1"># Used in generation of populations.</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>  <span class="c1"># Create samples</span>
<span class="linenos">11</span>  <span class="n">y</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
<span class="linenos">12</span>  <span class="n">y</span><span class="p">[</span><span class="n">N</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">N</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
<span class="linenos">13</span>  <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="p">]</span><span class="o">-</span><span class="mf">0.5</span>
<span class="linenos">14</span>
<span class="linenos">15</span>  <span class="c1"># Add drug column</span>
<span class="linenos">16</span>  <span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="s1">&#39;Placebo&#39;</span><span class="p">,</span> <span class="n">N</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="linenos">17</span>  <span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="s1">&#39;Drug&#39;</span><span class="p">,</span> <span class="n">N</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="linenos">18</span>  <span class="n">treatment</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">+</span> <span class="n">t2</span>
<span class="linenos">19</span>
<span class="linenos">20</span>  <span class="c1"># Add a `rep` column as the first variable for the 2 replicates of experiments done</span>
<span class="linenos">21</span>  <span class="n">rep</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">22</span>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="mi">2</span><span class="p">):</span>
<span class="linenos">23</span>      <span class="n">rep</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Rep1&#39;</span><span class="p">)</span>
<span class="linenos">24</span>      <span class="n">rep</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Rep2&#39;</span><span class="p">)</span>
<span class="linenos">25</span>
<span class="linenos">26</span>  <span class="c1"># Add a `genotype` column as the second variable</span>
<span class="linenos">27</span>  <span class="n">wt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="linenos">28</span>  <span class="n">mt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="linenos">29</span>  <span class="n">wt2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="linenos">30</span>  <span class="n">mt2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="linenos">31</span>
<span class="linenos">32</span>
<span class="linenos">33</span>  <span class="n">genotype</span> <span class="o">=</span> <span class="n">wt</span> <span class="o">+</span> <span class="n">mt</span> <span class="o">+</span> <span class="n">wt2</span> <span class="o">+</span> <span class="n">mt2</span>
<span class="linenos">34</span>
<span class="linenos">35</span>  <span class="c1"># Add an `id` column for paired data plotting.</span>
<span class="linenos">36</span>  <span class="nb">id</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<span class="linenos">37</span>  <span class="n">id_col</span> <span class="o">=</span> <span class="nb">id</span> <span class="o">+</span> <span class="nb">id</span>
<span class="linenos">38</span>
<span class="linenos">39</span>
<span class="linenos">40</span>  <span class="c1"># Combine all columns into a DataFrame.</span>
<span class="linenos">41</span>  <span class="n">df_delta2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;ID&#39;</span>        <span class="p">:</span> <span class="n">id_col</span><span class="p">,</span>
<span class="linenos">42</span>                    <span class="s1">&#39;Rep&#39;</span>      <span class="p">:</span> <span class="n">rep</span><span class="p">,</span>
<span class="linenos">43</span>                     <span class="s1">&#39;Genotype&#39;</span>  <span class="p">:</span> <span class="n">genotype</span><span class="p">,</span>
<span class="linenos">44</span>                     <span class="s1">&#39;Drug&#39;</span><span class="p">:</span> <span class="n">treatment</span><span class="p">,</span>
<span class="linenos">45</span>                     <span class="s1">&#39;Y&#39;</span>         <span class="p">:</span> <span class="n">y</span>
<span class="linenos">46</span>                  <span class="p">})</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>  <span class="n">df_delta2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
   <style scoped>
       .dataframe tbody tr th:only-of-type {
           vertical-align: middle;
       }

       .dataframe tbody tr th {
           vertical-align: top;
       }

       .dataframe thead th {
           text-align: right;
       }
   </style>
   <table border="1" class="dataframe">
     <thead>
       <tr style="text-align: right;">
         <th></th>
         <th>ID</th>
         <th>Rep</th>
         <th>Genotype</th>
         <th>Treatment</th>
         <th>Y</th>
       </tr>
     </thead>
     <tbody>
       <tr>
         <th>0</th>
         <td>0</td>
         <td>Rep1</td>
         <td>W</td>
         <td>Placebo</td>
         <td>2.793984</td>
       </tr>
       <tr>
         <th>1</th>
         <td>1</td>
         <td>Rep2</td>
         <td>W</td>
         <td>Placebo</td>
         <td>3.236759</td>
       </tr>
       <tr>
         <th>2</th>
         <td>2</td>
         <td>Rep1</td>
         <td>W</td>
         <td>Placebo</td>
         <td>3.019149</td>
       </tr>
       <tr>
         <th>3</th>
         <td>3</td>
         <td>Rep2</td>
         <td>W</td>
         <td>Placebo</td>
         <td>2.804638</td>
       </tr>
       <tr>
         <th>4</th>
         <td>4</td>
         <td>Rep1</td>
         <td>W</td>
         <td>Placebo</td>
         <td>2.858019</td>
       </tr>
     </tbody>
   </table>
   </div></section>
<section id="unpaired-data">
<h2>Unpaired Data<a class="headerlink" href="#unpaired-data" title="Permalink to this heading">¶</a></h2>
<p>To make a delta-delta plot, you need to simply set <code class="docutils literal notranslate"><span class="pre">delta2</span> <span class="pre">=</span> <span class="pre">True</span></code> in the
<code class="docutils literal notranslate"><span class="pre">dabest.load()</span></code> function. However, here <code class="docutils literal notranslate"><span class="pre">x</span></code> needs to be declared as a list
consisting of 2 elements rather than 1 in most of the cases. The first element
in <code class="docutils literal notranslate"><span class="pre">x</span></code> will be the variable plotted along the horizontal axis, and the second
one will determine the colour of dots for scattered plots or the colour of lines
for slopegraphs. We use the <code class="docutils literal notranslate"><span class="pre">experiment</span></code> input to specify grouping of the data.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>  <span class="n">unpaired_delta2</span> <span class="o">=</span> <span class="n">dabest</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df_delta2</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="s2">&quot;Genotype&quot;</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="n">delta2</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">2</span>              <span class="n">experiment</span> <span class="o">=</span> <span class="s2">&quot;Drug&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The above function creates the following object:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>  <span class="n">unpaired_delta2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DABEST v2023.02.14
================

Good afternoon!
The current time is Mon Mar  6 16:18:39 2023.

Effect size(s) with 95% confidence intervals will be computed for:
1. M Placebo minus W Placebo
2. M Drug minus W Drug
3. Drug minus Placebo (only for mean difference)

5000 resamples will be used to generate the effect size bootstraps.
</pre></div>
</div>
<p>We can quickly check out the effect sizes:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>  <span class="n">unpaired_delta2</span><span class="o">.</span><span class="n">mean_diff</span>
</pre></div>
</div>
<pre class="literal-block">DABEST v2023.02.14
================

Good afternoon!
The current time is Mon Mar  6 16:18:22 2023.

The unpaired mean difference between W Placebo and M Placebo is 1.23 [95%CI 0.948, 1.52].
The p-value of the two-sided permutation t-test is 0.0, calculated for legacy purposes only.

The unpaired mean difference between W Drug and M Drug is 0.326 [95%CI 0.0934, 0.584].
The p-value of the two-sided permutation t-test is 0.0122, calculated for legacy purposes only.

The delta-delta between Placebo and Drug is -0.903 [95%CI -1.26, -0.535].
The p-value of the two-sided permutation t-test is 0.0, calculated for legacy purposes only.

5000 bootstrap samples were taken; the confidence interval is bias-corrected and accelerated.
Any p-value reported is the probability of observing the effect size (or greater),
assuming the null hypothesis of zero difference is true.
For each p-value, 5000 reshuffles of the control and test labels were performed.

To get the results of all valid statistical tests, use <cite>.mean_diff.statistical_tests</cite></pre>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>  <span class="n">unpaired_delta2</span><span class="o">.</span><span class="n">mean_diff</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/tutorial_106_0.png" src="_images/tutorial_106_0.png" />
<p>In the above plot, the horizontal axis represents the <code class="docutils literal notranslate"><span class="pre">Genotype</span></code> condition
and the dot colour is also specified by <code class="docutils literal notranslate"><span class="pre">Genotype</span></code>. The left pair of
scattered plots is based on the <code class="docutils literal notranslate"><span class="pre">Placebo</span></code> group while the right pair is based
on the <code class="docutils literal notranslate"><span class="pre">Drug</span></code> group. The bottom left axis contains the two primary deltas: the <code class="docutils literal notranslate"><span class="pre">Placebo</span></code> delta
and the <code class="docutils literal notranslate"><span class="pre">Drug</span></code> delta. We can easily see that when only the placebo was
administered, the mutant phenotype is around 1.23 [95%CI 0.948, 1.52]. This difference was shrunken to around 0.326 [95%CI 0.0934, 0.584] when the drug was administered. This gives us some indication that the drug is effective in amiliorating the disease phenotype. Since the <code class="docutils literal notranslate"><span class="pre">Drug</span></code> did not completely eliminate the mutant phenotype, we have to calculate how much net effect the drug had. This is where <code class="docutils literal notranslate"><span class="pre">delta-delta</span></code> comes in. We use the <code class="docutils literal notranslate"><span class="pre">Placebo</span></code> delta as a reference for how much the mutant phenotype is supposed to be, and we subtract the <code class="docutils literal notranslate"><span class="pre">Drug</span></code> delta from it. The bootstrapped mean differences (delta-delta) between the <code class="docutils literal notranslate"><span class="pre">Placebo</span></code>
and <code class="docutils literal notranslate"><span class="pre">Drug</span></code> group are plotted at the right bottom with a separate y-axis from other bootstrap plots.
This effect size, at about -0.903 [95%CI -1.26, -0.535], is the net effect size of the drug treatment. That is to say that treatment with drug A reduced disease phenotype by 0.903.</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\hat{\theta}_{P} = \overline{X}_{P, M} - \overline{X}_{P, W}\\\hat{\theta}_{D} = \overline{X}_{D, M} - \overline{X}_{D, W}\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[\hat{\theta}_{\theta} = \hat{\theta}_{D} - \hat{\theta}_{P}\]</div>
<p>and:</p>
<div class="math notranslate nohighlight">
\[s_{\theta} = \frac{(n_{P, M}-1)s_{P, M}^2+(n_{P, W}-1)s_{P, W}^2+(n_{D, M}-1)s_{D, M}^2+(n_{D, M}-1)s_{D, M}^2}{(n_{P, M} - 1) + (n_{P, W} - 1) + (n_{D, M} - 1) + (n_{D, M} - 1)}\]</div>
<p>where <span class="math notranslate nohighlight">\(\overline{X}\)</span> is the sample mean, <span class="math notranslate nohighlight">\(\hat{\theta}\)</span> is the mean difference, <span class="math notranslate nohighlight">\(s\)</span> is the variance and <span class="math notranslate nohighlight">\(n\)</span> is the sample size.</p>
<p>In the example above, we used the convention of “test - control’ but you can manipulate the orders of experiment groups as well as the horizontal axis variable by setting <code class="docutils literal notranslate"><span class="pre">experiment_label</span></code> and <code class="docutils literal notranslate"><span class="pre">x1_level</span></code>.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>  <span class="n">unpaired_delta2_specified</span> <span class="o">=</span> <span class="n">dabest</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df_delta2</span><span class="p">,</span>
<span class="linenos">2</span>                                          <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="s2">&quot;Genotype&quot;</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span>
<span class="linenos">3</span>                                          <span class="n">delta2</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">experiment</span> <span class="o">=</span> <span class="s2">&quot;Treatment&quot;</span><span class="p">,</span>
<span class="linenos">4</span>                                          <span class="n">experiment_label</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Drug&quot;</span><span class="p">,</span> <span class="s2">&quot;Placebo&quot;</span><span class="p">],</span>
<span class="linenos">5</span>                                          <span class="n">x1_level</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="s2">&quot;W&quot;</span><span class="p">])</span>
<span class="linenos">6</span>
<span class="linenos">7</span>  <span class="n">unpaired_delta2_specified</span><span class="o">.</span><span class="n">mean_diff</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/tutorial_107_0.png" src="_images/tutorial_107_0.png" />
</section>
<section id="paired-data">
<h2>Paired Data<a class="headerlink" href="#paired-data" title="Permalink to this heading">¶</a></h2>
<p>The delta - delta function also supports paired data, which is useful for us to visualise the data in an alternate way. Assuming that the placebo and drug treatment were done on the same subjects, our data is paired between the treatment conditions. We can specify this by using <code class="docutils literal notranslate"><span class="pre">Treatment</span></code> as <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">Genotype</span></code> as <code class="docutils literal notranslate"><span class="pre">experiment</span></code>, and we further specify that <code class="docutils literal notranslate"><span class="pre">id_col</span></code> is <code class="docutils literal notranslate"><span class="pre">ID</span></code>, linking data from the same subject with each other. Since we have done two replicates of the experiments, we can also colour the slope lines according to <code class="docutils literal notranslate"><span class="pre">Rep</span></code>.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>  <span class="n">paired_delta2</span> <span class="o">=</span> <span class="n">dabest</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df_delta2</span><span class="p">,</span>
<span class="linenos">2</span>                              <span class="n">paired</span> <span class="o">=</span> <span class="s2">&quot;baseline&quot;</span><span class="p">,</span> <span class="n">id_col</span><span class="o">=</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span>
<span class="linenos">3</span>                              <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Treatment&quot;</span><span class="p">,</span> <span class="s2">&quot;Rep&quot;</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span>
<span class="linenos">4</span>                              <span class="n">delta2</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">experiment</span> <span class="o">=</span> <span class="s2">&quot;Genotype&quot;</span><span class="p">)</span>
<span class="linenos">5</span>  <span class="n">paired_delta2</span><span class="o">.</span><span class="n">mean_diff</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>We produce the following plot:</p>
<img alt="_images/tutorial_108_0.png" src="_images/tutorial_108_0.png" />
<p>We see that the drug had a non-specific effect of -0.321 [95%CI -0.498, -0.131] on wildtype subjects even when they were not sick, and it had a bigger effect of -1.22 [95%CI -1.52, -0.906] in mutant subjects. In this visualisation, we can see the delta-delta value of -0.903 [95%CI -1.21, -0.587] as the net effect of the drug accounting for non-specific actions in healthy individuals.</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\hat{\theta}_{W} = \overline{X}_{D, W} - \overline{X}_{P, W}\\\hat{\theta}_{W} = \overline{X}_{D, M} - \overline{X}_{P, M}\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[\hat{\theta}_{\theta} = \hat{\theta}_{M} - \hat{\theta}_{W}\]</div>
<p>and:</p>
<div class="math notranslate nohighlight">
\[s_{\theta} = \frac{(n_{D, W}-1)s_{D, W}^2+(n_{P, W}-1)s_{P, W}^2+(n_{D, M}-1)s_{D, M}^2+(n_{P, M}-1)s_{P, M}^2}{(n_{D, W} - 1) + (n_{P, W} - 1) + (n_{D, M} - 1) + (n_{P, M} - 1)}\]</div>
<p>where <span class="math notranslate nohighlight">\(\overline{X}\)</span> is the sample mean, <span class="math notranslate nohighlight">\(\hat{\theta}\)</span> is the mean difference, <span class="math notranslate nohighlight">\(s\)</span> is the variance and <span class="math notranslate nohighlight">\(n\)</span> is the sample size.</p>
</section>
<section id="connection-to-anova">
<h2>Connection to ANOVA<a class="headerlink" href="#connection-to-anova" title="Permalink to this heading">¶</a></h2>
<p>The configuration of comparison we performed above is reminiscent of a two-way ANOVA. In fact, the delta - delta is an effect size estimated for the interaction term between <code class="docutils literal notranslate"><span class="pre">Treatment</span></code> and <code class="docutils literal notranslate"><span class="pre">Genotype</span></code>. Main effects of <code class="docutils literal notranslate"><span class="pre">Treatment</span></code> and <code class="docutils literal notranslate"><span class="pre">Genotype</span></code>, on the other hand, can be determined by simpler, univariate contrast plots.</p>
</section>
<section id="omitting-delta-delta-plot">
<h2>Omitting Delta-delta Plot<a class="headerlink" href="#omitting-delta-delta-plot" title="Permalink to this heading">¶</a></h2>
<p>If for some reason you don’t want to display the delta-delta plot, you can easily do so by</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>  <span class="n">unpaired_delta2</span><span class="o">.</span><span class="n">mean_diff</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">show_delta2</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tutorial_109_0.png" src="_images/tutorial_109_0.png" />
</section>
<section id="other-effect-sizes">
<h2>Other Effect Sizes<a class="headerlink" href="#other-effect-sizes" title="Permalink to this heading">¶</a></h2>
<p>Since the delta-delta function is only applicable to mean differences, plots
of other effect sizes will not include a delta-delta bootstrap plot.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>  <span class="n">unpaired_delta2</span><span class="o">.</span><span class="n">cohens_d</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/tutorial_110_0.png" src="_images/tutorial_110_0.png" />
</section>
<section id="statistics">
<h2>Statistics<a class="headerlink" href="#statistics" title="Permalink to this heading">¶</a></h2>
<p>You can find all outputs of the delta - delta calculation by assessing the attribute named <code class="docutils literal notranslate"><span class="pre">delta_delta</span></code> of the
effect size object.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>  <span class="n">unpaired_delta2</span><span class="o">.</span><span class="n">mean_diff</span><span class="o">.</span><span class="n">delta_delta</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DABEST v2023.02.14
================

Good afternoon!
The current time is Mon Mar  6 15:50:44 2023.

The delta-delta between Placebo and Treatment is -0.903 [95%CI -1.26, -0.535].
The p-value of the two-sided permutation t-test is 0.0, calculated for legacy purposes only.

5000 bootstrap samples were taken; the confidence interval is bias-corrected and accelerated.
Any p-value reported is the probability of observing the effect size (or greater),
assuming the null hypothesis of zero difference is true.
For each p-value, 5000 reshuffles of the control and test labels were performed.
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">delta_delta</span></code> has its own attributes, containing various information of delta - delta.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">difference</span></code>: the mean bootstrapped differences between the 2 groups of bootstrapped mean differences</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bootstraps</span></code>: the 2 groups of bootstrapped mean differences</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bootstraps_delta_delta</span></code>: the bootstrapped differences between the 2 groups of bootstrapped mean differences</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">permutations</span></code>: the mean difference between the two groups of bootstrapped mean differences calculated based on the permutation data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">permutations_var</span></code>: the pooled group variances of two groups of bootstrapped mean differences calculated based on permutation data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">permutations_delta_delta</span></code>: the delta-delta calculated based on the permutation data</p></li>
</ul>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">delta_delta.to_dict()</span></code> will return to you all the attributes in a dictionary format.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">dabest</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=ACCLAB&repo=DABEST-python&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<p>
<a href="https://pypi.python.org/pypi/dabest/"><img src="https://badge.fury.io/py/dabest.svg" alt="PyPI version" height="18"></a>
</p><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="robust-beautiful.html">Robust and Beautiful Statistical Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="bootstraps.html">Bootstrap Confidence Intervals</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial: Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="repeatedmeasures.html">Tutorial: Repeated Measures</a></li>
<li class="toctree-l1"><a class="reference internal" href="proportion-plot.html">Tutorial: Proportion Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="minimetadelta.html">Tutorial: Mini-Meta Delta</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial: Delta - Delta</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotaesthetics.html">Tutorial: Controlling Plot Aesthetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Citing DABEST</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="minimetadelta.html" title="previous chapter">Tutorial: Mini-Meta Delta</a></li>
      <li>Next: <a href="plotaesthetics.html" title="next chapter">Tutorial: Controlling Plot Aesthetics</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016-2023, Joses W. Ho.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/deltadelta.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/ACCLAB/DABEST-python" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>